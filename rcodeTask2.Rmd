---
title: "RcodeT2"
output: html_document
---

```{r setup, include=TRUE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
library(graphics)
library(plyr)
library(foreign)
library(nnet)
library(ggplot2)
library(reshape2)
library(dplyr)
library(XML)
library(RCurl)
library(stringr)



#### 2a
my_data <- read.csv("~/School/2017-09/MSDS6306/CaseStudyTwoMaterials/Procrastination.csv",header=T,sep=",")
#### 2b
colnames(my_data)[1] <- c('Age')


#### 2c
#rapply(my_data,function(x)length(unique(x)))
str(my_data$How.long.have.you.held.this.position...Years)
summary(my_data$How.long.have.you.held.this.position...Years)
summary(my_data$How.long.have.you.held.this.position...Months)

# In order to correct for number of years I was thinking of using number of months but it seems 
# these fields should be  x years and y months since max(month) is 11. Since this part is judgmental/subjective) from what I can see in the data I can create a function and update the year field. below I put 
# some stats that can be usefull and some example function but based on stasts I may want to modify it to appear more appropriate values such that all 999 years are transform to mean/median (any meaningful number that can represent my data). 

str(my_data$Work.Status)
my_data$Work.Status <- sapply(my_data$Work.Status, as.character)
hist(my_data$Age)
hist(my_data$How.long.have.you.held.this.position...Years)
length(my_data$How.long.have.you.held.this.position...Years[my_data$How.long.have.you.held.this.position...Years > 30])
length(my_data$How.long.have.you.held.this.position...Years[my_data$How.long.have.you.held.this.position...Years == 999])

length(my_data$How.long.have.you.held.this.position...Years[my_data$How.long.have.you.held.this.position...Years > 30 & my_data$Work.Status == 'student'])
length(my_data$How.long.have.you.held.this.position...Years[my_data$How.long.have.you.held.this.position...Years > 30 & my_data$Work.Status == 'unemployed'])
length(my_data$How.long.have.you.held.this.position...Years[my_data$How.long.have.you.held.this.position...Years > 30 & my_data$Work.Status == 'full-time'])
length(my_data$How.long.have.you.held.this.position...Years[my_data$How.long.have.you.held.this.position...Years > 30 & my_data$Work.Status == 'part-time'])
length(my_data$How.long.have.you.held.this.position...Years[my_data$How.long.have.you.held.this.position...Years > 30 & my_data$Work.Status == 'retired'])
length(my_data$How.long.have.you.held.this.position...Years[my_data$How.long.have.you.held.this.position...Years > 30 & is.na(my_data$Work.Status)])
summary(my_data$How.long.have.you.held.this.position...Years[my_data$How.long.have.you.held.this.position...Years !=999])
summary(my_data$How.long.have.you.held.this.position...Years[my_data$Work.Status == 'full-time' & my_data$How.long.have.you.held.this.position...Years !=999])
summary(my_data$How.long.have.you.held.this.position...Years[my_data$Work.Status == 'student'])
summary(my_data$How.long.have.you.held.this.position...Years[my_data$Work.Status == 'student' & my_data$How.long.have.you.held.this.position...Years !=999])


  year_correctin <- function(year,age,workStat){
  if (is.na(year)) {return(year)}
  else if (year == 999 & (is.na(age) | age < 18) & is.na(workStat)) {return(4)}
  else if (year == 999 & (is.na(age) | age < 18) & workStat == 'unemployed') {return(3)}
  else if (year == 999 & (is.na(age) | age < 18) & workStat == 'student') {return(2)}
  else if (year == 999 & (is.na(age) | age < 18) & workStat == 'full-time') {return(5)}
  else if (year == 999 & (is.na(age) | age < 18) & workStat == 'retired') {return(4)}
  else if (year == 999 & (is.na(age) | age < 18) & workStat == 'part-time') {return(4)}
  else if (year == 999 & age < 31 & is.na(workStat)) {return(2)}
  else if (year == 999 & age < 31 & workStat == 'unemployed') {return(1)}
  else if (year == 999 & age < 31 & workStat == 'student') {return(2)}
  else if (year == 999 & age < 31 & workStat == 'full-time') {return(2)}
  else if (year == 999 & age < 31 & workStat == 'part-time') {return(1)}
  else if (year == 999 & age < 31 & workStat == 'retired') {return(1)}
  else if (year == 999 & (age > 30 & age < 51) & is.na(workStat)) {return(5)}
  else if (year == 999 & (age > 30 & age < 51) & workStat == 'unemployed') {return(3)}
  else if (year == 999 & (age > 30 & age < 51) & workStat == 'retired') {return(6)}
  else if (year == 999 & (age > 30 & age < 51) & workStat == 'student') {return(3)}
  else if (year == 999 & (age > 30 & age < 51) & workStat == 'full-time') {return(5)}
  else if (year == 999 & (age > 30 & age < 51) & workStat == 'part-time') {return(5)}
  else if (year == 999 & (age > 50 & age < 65) & is.na(workStat)) {return(8)}
  else if (year == 999 & (age > 50 & age < 65) & workStat == 'unemployed') {return(5)}
  else if (year == 999 & (age > 50 & age < 65) & workStat == 'retired') {return(3)}
  else if (year == 999 & (age > 50 & age < 65) & workStat == 'student') {return(4)}
  else if (year == 999 & (age > 50 & age < 65) & workStat == 'full-time') {return(9)}
  else if (year == 999 & (age > 50 & age < 65) & workStat == 'part-time') {return(6)}
  else if (year == 999 & age > 64 & is.na(workStat)) {return(2)}
  else if (year == 999 & age > 64 & workStat == 'unemployed') {return(6)}
  else if (year == 999 & age > 64 & workStat == 'full-time') {return(12)}
  else if (year == 999 & age > 64 & workStat == 'part-time') {return(9)}
  else if (year == 999 & age > 64 & workStat == 'retired') {return(4)}
  else if (year == 999 & age == 67.5 & workStat == 'student') {return(4)}
  else if (year < 1) { return(0) }	
  else {return(year)}
	}

my_data$How.long.have.you.held.this.position...Years <- mapply(year_correctin, my_data$How.long.have.you.held.this.position...Years, my_data$Age, my_data$Work.Status)

# . 
# I first changed it to string then replaced the values and converted the field to numeric
str(my_data$Number.of.sons) 
my_data$Number.of.sons <- sapply(my_data$Number.of.sons, as.character)
my_data$Number.of.sons[my_data$Number.of.sons == "Male"] <- "1"
my_data$Number.of.sons[my_data$Number.of.sons == "Female"] <- "2"
my_data$Number.of.sons <- sapply(my_data$Number.of.sons, as.numeric)
summary(my_data$Number.of.sons) 

#  
# I first changed it to string then replaced the values and converted the field to factor again but you can keep as character
str(my_data$Country.of.residence) 
summary(my_data$Country.of.residence) 
my_data$Country.of.residence <- sapply(my_data$Country.of.residence, as.character)
my_data$Country.of.residence[my_data$Country.of.residence == "0"] <- NA

#  
# I first changed it to string then replaced the values and converted the field to factor again but you can keep as character
str(my_data$Current.Occupation) 
summary(my_data$Current.Occupation) 
my_data$Current.Occupation <- sapply(my_data$Current.Occupation, as.character)
my_data$Current.Occupation[my_data$Current.Occupation == "0" | my_data$Current.Occupation == "" | my_data$Current.Occupation == "please specify"] <- NA

#### 2d
 my_data$Gender<- sapply(my_data$Gender, as.character)
 my_data$Kids<- sapply(my_data$Kids, as.character)
 my_data$Edu<- sapply(my_data$Edu, as.character)
 my_data$Marital.Status<- sapply(my_data$Marital.Status, as.character)
 my_data$Marital.Status[my_data$Marital.Status == "0"] <- NA
 my_data$Community.size<- sapply(my_data$Community.size, as.character)
 my_data$Community.size[my_data$Community.size =="0" | my_data$Community.size =="8"] <- NA
 my_data$Do.others.consider.you.a.procrastinator.<- sapply(my_data$Do.others.consider.you.a.procrastinator., as.character)
 my_data$Do.you.consider.yourself.a.procrastinator.<- sapply(my_data$Do.you.consider.yourself.a.procrastinator., as.character)
 my_data$Do.others.consider.you.a.procrastinator.[my_data$Do.others.consider.you.a.procrastinator. == "0" | my_data$Do.others.consider.you.a.procrastinator.== "4" ] <- NA
 
 #### 2e
 my_data$DPMean<- rowMeans(my_data[,15:19])
 my_data$AIPMean<- rowMeans(my_data[,20:34])
 my_data$GPMean<- rowMeans(my_data[,35:54])
 my_data$SWLSMean<- rowMeans(my_data[,55:59])
 
 

```


```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
